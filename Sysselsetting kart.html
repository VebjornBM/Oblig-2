<!doctype html>
<html>
  <head>
  <title>Mapbox kartet</title>
    <meta charset="utf-8">
    <link "type=text/css" rel="stylesheet" href="Sysselsetting kart.css">
    <link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">
    <!--Laster ned font-family crimson mens siden laster inn. så man kan bruke denne.-->


    <script src='https://api.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.26.0/mapbox-gl.css' rel='stylesheet' />



  </head>
  <body>



    <div id='map'></div>
    <div class='map-overlay' id='features'><h2>Endring i gjennomsnittsalder i Opplands kommuner</h2><div id='pd'><p>Dette kartet viser endringen i antall år på gjennomsnittsalderen til sysselsatte i Oppland fylke fordelt på kommune.</p></div></div>
    <div class='map-overlay' id='legend'></div>
    <div class='map-overlay' id='info_box'></div>
    <div class='map-overlay' id='info_box2'></div>
    <script>

    // define access token
    mapboxgl.accessToken = 'pk.eyJ1IjoidmViam9ybm05NCIsImEiOiJjaXZheHZwcTAwMDJ0Mm9tcWRzNXdsd2M4In0._sHKHCGhWzFH2we_pRAsDg';

    //create map
    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/vebjornm94/civ9edxzx00002ip2eoei9ftm' // map style URL from Mapbox Studio
    });

    // wait for map to load before adjusting it
    map.on('load', function() {

        // define layer names
        var layers = ['S_1.4-1.9', 'S_2-2.5', 'S_2.6-2.9', 'S_3-3.4', 'S_3.5-4']

        // create legend
        layers.forEach(function(layer) {;
            var color = map.getPaintProperty(layer, 'fill-color');
            var item = document.createElement('div');
            var key = document.createElement('span');
            key.className = 'legend-key';
            key.style.backgroundColor = color;

            var value = document.createElement('span');
            value.innerHTML = layer;
            item.appendChild(key);
            item.appendChild(value);
            legend.appendChild(item);
        });
    });

    map.on('mousemove', function(e) {
      var sysselsatt = map.queryRenderedFeatures(e.point, {
        layers: sysselsatt
      });

      if (sysselsatt[0].properties.K_ID > 400) {
        document.getElementById('info_box').innerHTML = '<h3><strong>' + sysselsatt[0].properties.Kommune + '</strong></h3><h4>Endring: ' + sysselsatt[0].properties.Endring_pr + '</h4><h4>2000:    ' + sysselsatt[0].properties.F2 + '</h4><h4>2015: '+ sysselsatt[0].properties.F16 + '</h4>';
      } else {
        document.getElementById('info_box').innerHTML = '<p>Pek over en kommune for å se statistikk</p>';
        //sysselsatt[0].style.opacity = 0.5;
      }
    });
    map.getCanvas().style.cursor = 'default';

    </script>
  </body>
</html>
